<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI Water & Carbon Footprint Calculator</title>
  <!-- Tailwind via Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Chart.js for simple charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* Subtle gradient background */
    body { background: linear-gradient(180deg, #0f172a 0%, #111827 100%); }
    .card { backdrop-filter: blur(6px); }
    .number-input::-webkit-outer-spin-button, .number-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .number-input { -moz-appearance: textfield; }
  </style>
</head>
<body class="text-slate-100 min-h-screen">
  <header class="max-w-5xl mx-auto px-4 pt-10">
    <div class="flex items-center justify-between">
      <h1 class="text-2xl md:text-3xl font-semibold tracking-tight">AI Water & Carbon Footprint Calculator</h1>
      <a href="https://github.com/new" target="_blank" class="hidden md:inline-flex items-center gap-2 text-sm px-3 py-2 rounded-xl bg-indigo-600 hover:bg-indigo-500 transition">Fork / Deploy</a>
    </div>
    <p class="mt-3 text-slate-300 max-w-3xl">Quickly estimate the water and CO₂ impact of AI usage (e.g., ChatGPT prompts). All assumptions are editable. Values are <span class="italic">order-of-magnitude</span> only—models and data centers vary widely.</p>
  </header>

  <main class="max-w-5xl mx-auto px-4 pb-20">
    <!-- Controls -->
    <section class="mt-8 grid md:grid-cols-2 gap-6">
      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Usage</h2>
        <div class="space-y-4">
          <label class="block">
            <span class="text-sm text-slate-300">Prompts / day</span>
            <input id="promptsPerDay" type="number" min="0" value="80" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
          </label>
          <label class="block">
            <span class="text-sm text-slate-300">Days / month</span>
            <input id="daysPerMonth" type="number" min="1" max="31" value="30" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
          </label>
          <label class="block">
            <span class="text-sm text-slate-300">Power Usage Effectiveness (PUE)</span>
            <input id="pue" type="number" min="1" step="0.01" value="1.3" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <p class="text-xs text-slate-400 mt-1">Overhead multiplier for data center cooling & facility load. Typical range 1.1–1.6.</p>
          </label>
        </div>
      </div>

      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Per‑prompt assumptions</h2>
        <div class="space-y-4">
          <label class="block">
            <span class="text-sm text-slate-300">Energy per prompt (Wh)</span>
            <input id="whPerPrompt" type="number" min="0" step="0.01" value="0.5" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <p class="text-xs text-slate-400 mt-1">Rough order of magnitude. Heavier models or longer contexts cost more. Edit as needed.</p>
          </label>
          <label class="block">
            <span class="text-sm text-slate-300">Direct cooling water per prompt (mL)</span>
            <input id="waterMlPerPrompt" type="number" min="0" step="1" value="30" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <p class="text-xs text-slate-400 mt-1">Midpoint estimate based on public studies for LLM inference. Set to 0 if you want to model via kWh × L/kWh only.</p>
          </label>
        </div>
      </div>

      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Electricity & emissions</h2>
        <div class="space-y-4">
          <label class="block">
            <span class="text-sm text-slate-300">Grid carbon intensity (gCO₂/kWh)</span>
            <input id="gridIntensity" type="number" min="0" step="1" value="500" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <p class="text-xs text-slate-400 mt-1">Use your region’s latest figure. Lower on renewables; higher on fossil grids.</p>
          </label>
          <label class="block">
            <span class="text-sm text-slate-300">Water use from power generation (L/kWh) — optional</span>
            <input id="waterPerKwh" type="number" min="0" step="0.1" value="0" class="number-input mt-1 w-full rounded-xl bg-white/10 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <p class="text-xs text-slate-400 mt-1">If you want to include upstream water at the power plant. Highly regional; default 0.</p>
          </label>
        </div>
      </div>

      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Presets</h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="frugal">Frugal</button>
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="typical">Typical</button>
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="heavy">Heavy</button>
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="renewables">Renewables‑rich grid</button>
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="fossil">Fossil‑heavy grid</button>
          <button class="preset px-3 py-2 rounded-xl bg-slate-700 hover:bg-slate-600 text-sm" data-preset="powerwater">Add power‑plant water</button>
        </div>
        <p class="text-xs text-slate-400 mt-3">Presets update fields above. Treat as illustrative, not authoritative.</p>
      </div>
    </section>

    <!-- Actions -->
    <div class="mt-6 flex flex-wrap items-center gap-3">
      <button id="calcBtn" class="px-4 py-2 rounded-xl bg-indigo-600 hover:bg-indigo-500">Recalculate</button>
      <button id="resetBtn" class="px-4 py-2 rounded-xl bg-slate-700 hover:bg-slate-600">Reset</button>
      <button id="exportBtn" class="px-4 py-2 rounded-xl bg-slate-700 hover:bg-slate-600">Export CSV</button>
      <span id="status" class="text-sm text-slate-400"></span>
    </div>

    <!-- Results -->
    <section class="mt-6 grid lg:grid-cols-2 gap-6">
      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Results</h2>
        <div class="grid grid-cols-2 gap-4 text-center">
          <div class="rounded-xl bg-black/20 p-4">
            <div class="text-2xl font-semibold" id="dailyWaterL">–</div>
            <div class="text-xs text-slate-400">Daily water (L)</div>
          </div>
          <div class="rounded-xl bg-black/20 p-4">
            <div class="text-2xl font-semibold" id="monthlyWaterL">–</div>
            <div class="text-xs text-slate-400">Monthly water (L)</div>
          </div>
          <div class="rounded-xl bg-black/20 p-4">
            <div class="text-2xl font-semibold" id="dailyCO2g">–</div>
            <div class="text-xs text-slate-400">Daily CO₂ (g)</div>
          </div>
          <div class="rounded-xl bg-black/20 p-4">
            <div class="text-2xl font-semibold" id="monthlyCO2kg">–</div>
            <div class="text-xs text-slate-400">Monthly CO₂ (kg)</div>
          </div>
        </div>
        <p class="text-xs text-slate-400 mt-4">CO₂ calculation: prompts × Wh × PUE → kWh × grid intensity. Water = (prompts × direct mL) + (kWh × L/kWh).</p>
      </div>

      <div class="card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
        <h2 class="text-lg font-semibold mb-4">Breakdown</h2>
        <canvas id="chart"></canvas>
      </div>
    </section>

    <section class="mt-8 card rounded-2xl bg-white/5 ring-1 ring-white/10 p-5">
      <h3 class="text-base font-semibold mb-2">Disclosure & Caveats</h3>
      <ul class="list-disc list-inside text-sm text-slate-300 space-y-1">
        <li>Numbers are illustrative. Real figures vary by model size, sequence length, data center, hardware generation, and ambient temperature.</li>
        <li>Default direct water per prompt (30 mL) is a midpoint from public estimates of LLM inference. Adjust as needed.</li>
        <li>Set power‑plant water to model upstream cooling at generators. Many grids report this as consumptive water intensity (L/kWh).</li>
        <li>For training runs, replace “prompts/day” with equivalent GPU‑hours → kWh inputs; this tool focuses on inference.</li>
      </ul>
    </section>

    <footer class="mt-10 text-xs text-slate-400">
      <p>Single‑file app. Drop <code>index.html</code> into any static host (GitHub Pages, Netlify, S3). No tracking, no external APIs.</p>
    </footer>
  </main>

  <script>
    const el = id => document.getElementById(id);

    const inputs = [
      'promptsPerDay','daysPerMonth','pue','whPerPrompt','waterMlPerPrompt','gridIntensity','waterPerKwh'
    ];

    // Load & Save state
    function loadState() {
      try { const s = JSON.parse(localStorage.getItem('aiFootprintState')||'{}'); inputs.forEach(k=>{ if(s[k]!==undefined) el(k).value = s[k]; }); } catch {}
    }
    function saveState() {
      const s = {}; inputs.forEach(k=> s[k] = parseFloat(el(k).value||0));
      localStorage.setItem('aiFootprintState', JSON.stringify(s));
      el('status').textContent = 'Saved.'; setTimeout(()=> el('status').textContent='', 1200);
    }

    inputs.forEach(k=> el(k).addEventListener('change', saveState));

    // Presets
    const presets = {
      frugal:      { whPerPrompt: 0.2, waterMlPerPrompt: 10, pue: 1.2 },
      typical:     { whPerPrompt: 0.5, waterMlPerPrompt: 30, pue: 1.3 },
      heavy:       { whPerPrompt: 1.5, waterMlPerPrompt: 50, pue: 1.5 },
      renewables:  { gridIntensity: 80 },
      fossil:      { gridIntensity: 800 },
      powerwater:  { waterPerKwh: 1.5 }
    };

    document.querySelectorAll('.preset').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const p = presets[btn.dataset.preset];
        Object.entries(p).forEach(([k,v])=>{ if(el(k)) el(k).value = v; });
        saveState();
        calculate();
      });
    });

    // Calculator
    let chart;
    function calculate() {
      const promptsPerDay = parseFloat(el('promptsPerDay').value)||0;
      const daysPerMonth  = parseFloat(el('daysPerMonth').value)||0;
      const pue           = Math.max(1, parseFloat(el('pue').value)||1.3);
      const whPerPrompt   = Math.max(0, parseFloat(el('whPerPrompt').value)||0);
      const waterMlPerPrompt = Math.max(0, parseFloat(el('waterMlPerPrompt').value)||0);
      const gridIntensity = Math.max(0, parseFloat(el('gridIntensity').value)||0); // gCO2/kWh
      const waterPerKwh   = Math.max(0, parseFloat(el('waterPerKwh').value)||0);   // L/kWh

      const promptsPerMonth = promptsPerDay * daysPerMonth;

      // Energy
      const kWhDay   = (promptsPerDay * whPerPrompt * pue) / 1000; // kWh/day
      const kWhMonth = (promptsPerMonth * whPerPrompt * pue) / 1000; // kWh/month

      // Emissions
      const co2gDay  = kWhDay * gridIntensity; // g/day
      const co2kgMon = (kWhMonth * gridIntensity) / 1000; // kg/month

      // Water
      const directWaterLDay  = (promptsPerDay * waterMlPerPrompt) / 1000; // L/day
      const directWaterLMon  = (promptsPerMonth * waterMlPerPrompt) / 1000; // L/month
      const powerWaterLDay   = kWhDay * waterPerKwh; // L/day
      const powerWaterLMonth = kWhMonth * waterPerKwh; // L/month

      const totalWaterLDay   = directWaterLDay + powerWaterLDay;
      const totalWaterLMonth = directWaterLMon + powerWaterLMonth;

      // Update UI
      el('dailyWaterL').textContent   = totalWaterLDay.toFixed(2);
      el('monthlyWaterL').textContent = totalWaterLMonth.toFixed(2);
      el('dailyCO2g').textContent     = co2gDay.toFixed(0);
      el('monthlyCO2kg').textContent  = co2kgMon.toFixed(2);

      // Chart
      const ctx = document.getElementById('chart').getContext('2d');
      const data = {
        labels: ['Water (L/day)', 'CO₂ (g/day)', 'Energy (kWh/day)'],
        datasets: [{
          label: 'Daily impact',
          data: [totalWaterLDay, co2gDay, kWhDay],
        }]
      };
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'bar',
        data,
        options: {
          responsive: true,
          plugins: { legend: { display: false } },
          scales: {
            y: { beginAtZero: true }
          }
        }
      });

      return {
        promptsPerDay, daysPerMonth, pue, whPerPrompt, waterMlPerPrompt, gridIntensity, waterPerKwh,
        kWhDay, kWhMonth, co2gDay, co2kgMon, directWaterLDay, directWaterLMon, powerWaterLDay, powerWaterLMonth, totalWaterLDay, totalWaterLMonth
      };
    }

    // Export CSV
    function exportCSV() {
      const r = calculate();
      const rows = [
        ['Metric','Value','Unit'],
        ['Prompts per day', r.promptsPerDay, 'prompts'],
        ['Days per month', r.daysPerMonth, 'days'],
        ['Energy per prompt', r.whPerPrompt, 'Wh/prompt'],
        ['PUE', r.pue, 'ratio'],
        ['Grid intensity', r.gridIntensity, 'gCO2/kWh'],
        ['Direct water per prompt', r.waterMlPerPrompt, 'mL/prompt'],
        ['Power-plant water', r.waterPerKwh, 'L/kWh'],
        ['Energy (day)', r.kWhDay.toFixed(4), 'kWh'],
        ['Energy (month)', r.kWhMonth.toFixed(4), 'kWh'],
        ['CO2 (day)', r.co2gDay.toFixed(0), 'g'],
        ['CO2 (month)', r.co2kgMon.toFixed(2), 'kg'],
        ['Direct water (day)', r.directWaterLDay.toFixed(2), 'L'],
        ['Direct water (month)', r.directWaterLMon.toFixed(2), 'L'],
        ['Power water (day)', r.powerWaterLDay.toFixed(2), 'L'],
        ['Power water (month)', r.powerWaterLMonth.toFixed(2), 'L'],
        ['Total water (day)', r.totalWaterLDay.toFixed(2), 'L'],
        ['Total water (month)', r.totalWaterLMonth.toFixed(2), 'L']
      ];
      const csv = rows.map(r=> r.join(',')).join('\n');
      const blob = new Blob([csv], {type: 'text/csv'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'ai_footprint.csv'; a.click();
      URL.revokeObjectURL(url);
    }

    // Buttons
    el('calcBtn').addEventListener('click', ()=>{ calculate(); });
    el('resetBtn').addEventListener('click', ()=>{ localStorage.removeItem('aiFootprintState'); location.reload(); });
    el('exportBtn').addEventListener('click', exportCSV);

    // Init
    loadState();
    calculate();
  </script>
</body>
</html>
